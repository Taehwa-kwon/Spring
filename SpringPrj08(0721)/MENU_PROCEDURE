CREATE OR REPLACE
PACKAGE BODY PKG_MBOARD AS

     --기본 출력 프로시저(출력을 하려면 O_CUR 가 필요하다)
  PROCEDURE PROC_MENU_LIST(
    O_CUR OUT SYS_REFCURSOR
  ) 
  AS
  
  BEGIN
    OPEN O_CUR FOR
    SELECT MENU_ID, MENU_NAME, MENU_SEQ
    FROM MENUS
    ORDER BY MENU_SEQ ASC
    ;
    
  END 
  PROC_MENU_LIST
  ;

        -- 추가 프로시저 
  PROCEDURE PROC_MENU_INSERT(
    IN_MENU_NAME VARCHAR2    --프로시저 외부에서 값을 받아오는것
  ) 
  AS
    V_MENU_ID CHAR(6);
    V_MENU_SEQ NUMBER(5,0);
 
  BEGIN
        --MENU_ID
    SELECT 'MENU'||TRIM(TO_CHAR(TO_NUMBER(SUBSTR(NVL(MAX(MENU_ID), 'MENU00') ,5,2))+1,'00')) INTO V_MENU_ID
    FROM MENUS;
    
        --MENU_SEQ
    SELECT NVL(MAX(MENU_SEQ),0)+1 INTO V_MENU_SEQ
    FROM MENUS;
    
    INSERT INTO MENUS (MENU_ID, MENU_NAME, MENU_SEQ)
    VALUES ( V_MENU_ID, IN_MENU_NAME, V_MENU_SEQ )
    ;
    
  END 
  PROC_MENU_INSERT
  ;

END 
PKG_MBOARD
;


---------------------------------------

SET SERVEROUTPUT ON;

DECLARE
  REC_MENU MENUS%ROWTYPE;
  O_CUR SYS_REFCURSOR;
BEGIN
  PKG_MBOARD.PROC_MENU_LIST ( O_CUR );
  LOOP
    FETCH O_CUR INTO REC_MENU;
    EXIT WHEN O_CUR%NOTFOUND;
  
  DBMS_OUTPUT.PUT_LINE('메뉴번호' || REC_MENU.MENU_ID);
  DBMS_OUTPUT.PUT_LINE('메뉴이름' || REC_MENU.MENU_NAME);
  DBMS_OUTPUT.PUT_LINE('메뉴순서' || REC_MENU.MENU_SEQ);
  
   END LOOP;
  
END;
/